# -*- coding: utf-8 -*-
"""
外卖扭蛋机・最终完整版菜品库（减脂 20 类 + 放纵 25 类）
- 减脂：品类 → 推荐菜品 + 减脂建议（1.2.3. 同一块）；热量按分类区间。
- 放纵：品类 → 推荐搭配 + 快乐提示；存具体品类名；热量 500-1200。
"""
import random

# ---------- 减脂模式：品类 → 推荐菜品 + 减脂建议（列表） ----------
DIET_FOODS = {
    "麦当劳": {
        "搭配": "双吉士汉堡（不加酱）、板烧鸡腿堡（去酱）、烤鸡胸沙拉、鲜蔬杯",
        "注意事项": [
            "去掉酱料和多余面包，只吃肉饼和蔬菜。",
            "搭配无糖饮料，不喝含糖饮料。",
            "不搭配薯条、麦乐鸡等高脂小食。",
        ],
    },
    "肯德基": {
        "搭配": "烤鸡腿堡（去皮）、奥尔良烤翅（去皮）、玉米杯、鸡胸沙拉",
        "注意事项": [
            "去皮食用，不吃鸡皮和油脂。",
            "不搭配薯条、蛋挞、甜筒等高糖高脂食物。",
            "用玉米杯替代薯条，增加膳食纤维。",
        ],
    },
    "汉堡王": {
        "搭配": "皇堡（不加酱）、单层牛肉堡（去面包）、烤鸡沙拉",
        "注意事项": [
            "去掉酱料和多余面包，只吃肉饼和蔬菜。",
            "不搭配洋葱圈、薯角等高脂小食。",
            "搭配无糖可乐或白水。",
        ],
    },
    "赛百味": {
        "搭配": "火鸡胸 / 烤鸡三明治（全麦面包，不加酱）、蔬菜沙拉",
        "注意事项": [
            "选择全麦面包，避免白面包。",
            "酱料只选黄芥末 / 油醋汁，不选蛋黄酱 / 千岛酱。",
            "额外加一份蔬菜，增加饱腹感。",
        ],
    },
    "老乡鸡": {
        "搭配": "蒸鸡胸 + 杂粮饭、蒸蛋 + 小炒肉（去油）、鸡汤（去油）+ 青菜、清炒时蔬",
        "注意事项": [
            "不吃鸡汤里的油脂，只喝清汤。",
            "米饭减半，不吃沾了汤汁的米饭。",
            "备注少油少盐，避免额外油脂。",
        ],
    },
    "真功夫": {
        "搭配": "香滑蒸蛋、瘦肉肠粉、白灼菜心、蒸鸡腿饭（去鸡皮）",
        "注意事项": [
            "不吃鸡皮和肥肉，只吃瘦肉和蔬菜。",
            "米饭减半，不喝菜汤。",
            "不搭配油条、奶黄包等高碳水食物。",
        ],
    },
    "沙县小吃": {
        "搭配": "蒸饺（不蘸酱）、乌鸡汤（去油）、青菜瘦肉粉（少粉多菜）",
        "注意事项": [
            "蒸饺不蘸花生酱 / 甜辣酱，直接吃。",
            "粉类少粉多菜，避免大量碳水。",
            "不搭配卤味、炸物等高脂食物。",
        ],
    },
    "大米先生/乡村基": {
        "搭配": "清炒时蔬、蒸蛋、香煎鸡胸、杂粮饭",
        "注意事项": [
            "多选蒸、煮、清炒菜品，少选红烧、油焖。",
            "米饭半碗，不喝油汤。",
            "优先搭配两种以上蔬菜。",
        ],
    },
    "砂锅": {
        "搭配": "砂锅牛肉、砂锅丝瓜、米饭",
        "注意事项": [
            "米饭吃一半，不吃沾了酱汁的米饭，不喝汤。",
            "选择有精瘦肉、蔬菜的品类，额外点一份青菜。",
            "备注少油少盐。",
        ],
    },
    "粥铺": {
        "搭配": "瘦肉粥、青菜粥、白煮蛋、凉拌黄瓜",
        "注意事项": [
            "粥不要加糖，不选甜粥。",
            "搭配鸡蛋补充蛋白，不搭配油条、煎饺。",
            "控制粥量，避免碳水过量。",
        ],
    },
    "面馆": {
        "搭配": "清汤牛肉面、鸡丝面（少面多菜）、凉拌青菜",
        "注意事项": [
            "面量减半，多放青菜和肉。",
            "不喝浮油汤底，不加油炸配料。",
            "备注少油、不辣。",
        ],
    },
    "水饺/馄饨": {
        "搭配": "白菜猪肉水饺（不蘸酱）、虾仁馄饨（清汤）",
        "注意事项": [
            "不蘸辣椒油、香油、芝麻酱。",
            "控制数量，8–12 个为宜。",
            "搭配一份清汤青菜。",
        ],
    },
    "湘菜": {
        "搭配": "小炒黄牛肉（去油）+ 青菜、清蒸鱼 + 白灼菜心、番茄炒蛋（少油）、冬瓜排骨汤（去油）",
        "注意事项": [
            "少油少盐，不吃肥肉和汤汁。",
            "搭配白灼菜心，增加膳食纤维。",
            "不搭配米饭或米饭减半，避免碳水超标。",
        ],
    },
    "粤菜": {
        "搭配": "白切鸡（去皮）+ 青菜、清蒸鲈鱼、白灼虾 + 生菜、滑鸡煲（少油）",
        "注意事项": [
            "去皮食用，不吃鸡皮和油脂。",
            "选择清蒸 / 白灼做法，避免油炸、红烧。",
            "不搭配炒饭、炒面等高碳水主食。",
        ],
    },
    "川菜": {
        "搭配": "水煮牛肉（去油）、清炒时蔬、番茄鸡蛋汤（去油）",
        "注意事项": [
            "去掉表面红油，只吃肉和蔬菜。",
            "不搭配米饭或米饭减半。",
            "备注少油少盐，避免额外油脂。",
        ],
    },
    "江浙菜": {
        "搭配": "清蒸鱼、白灼虾、清炒时蔬、菌菇汤",
        "注意事项": [
            "选择清蒸 / 白灼做法，避免红烧、糖醋。",
            "不搭配甜口菜品（如糖醋排骨）。",
            "搭配一碗清汤，增加饱腹感。",
        ],
    },
    "轻食沙拉": {
        "搭配": "鸡胸肉沙拉、牛肉沙拉、蔬菜沙拉（油醋汁）",
        "注意事项": [
            "酱料只选油醋汁 / 黄芥末，不选沙拉酱 / 千岛酱。",
            "额外加一份蛋白质（鸡胸 / 牛肉），增加饱腹感。",
            "不搭配面包、croutons 等高碳水配料。",
        ],
    },
    "麻辣烫": {
        "搭配": "清汤 + 鸡胸 + 蔬菜、番茄汤底 + 虾滑 + 青菜、菌菇汤底 + 牛肉 + 藕片",
        "注意事项": [
            "选择清汤 / 番茄汤底，避免麻辣汤底。",
            "多菜少肉，优先鸡胸、虾滑、蔬菜。",
            "不搭配粉丝、方便面等高碳水食材。",
        ],
    },
    "日料": {
        "搭配": "三文鱼刺身 + 海藻沙拉、烤青花鱼 + 蔬菜沙拉、手握寿司（不蘸酱）",
        "注意事项": [
            "刺身不蘸酱油，避免额外钠摄入。",
            "不吃天妇罗、炸物等高脂食物。",
            "搭配味增汤（去油），增加饱腹感。",
        ],
    },
    "韩料": {
        "搭配": "石锅拌饭（少饭多菜）、部队火锅（去汤，多菜少肉）、烤五花肉（去皮）",
        "注意事项": [
            "石锅拌饭少饭多菜，不吃锅巴。",
            "部队火锅去汤，避免喝汤汁。",
            "不搭配炸鸡、芝士年糕等高脂高糖食物。",
        ],
    },
}

# 减脂：品类 → 分类（用于查热量区间）
DIET_CATEGORY_MAP = {
    "麦当劳": "快餐连锁类",
    "肯德基": "快餐连锁类",
    "汉堡王": "快餐连锁类",
    "赛百味": "快餐连锁类",
    "老乡鸡": "中式快餐类",
    "真功夫": "中式快餐类",
    "沙县小吃": "中式快餐类",
    "大米先生/乡村基": "中式快餐类",
    "砂锅": "中式快餐类",
    "粥铺": "中式快餐类",
    "面馆": "中式快餐类",
    "水饺/馄饨": "中式快餐类",
    "湘菜": "地方菜系类",
    "粤菜": "地方菜系类",
    "川菜": "地方菜系类",
    "江浙菜": "地方菜系类",
    "轻食沙拉": "轻食・健康餐类",
    "麻辣烫": "轻食・健康餐类",
    "日料": "轻食・健康餐类",
    "韩料": "轻食・健康餐类",
}

# 减脂：分类 → 热量区间 (kcal)，步长 10
DIET_CALORIE_BY_CATEGORY = {
    "快餐连锁类": (250, 400),
    "中式快餐类": (300, 450),
    "地方菜系类": (350, 500),
    "轻食・健康餐类": (200, 400),
}
# 品类级热量覆盖（如赛百味 200-400）
DIET_CALORIE_OVERRIDE = {"赛百味": (200, 400)}

# ---------- 放纵模式：品类 → 推荐搭配统一「点你喜欢吃的」+ 快乐提示统一 ----------
INDULGE_快乐提示 = "今天开心最重要，不用控制！"
INDULGE_FOODS = {
    "炸鸡": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "汉堡": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "薯条": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "披萨": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "湘菜": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "川菜": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "粤菜": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "烧烤": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "火锅": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "麻辣烫": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "螺蛳粉": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "炸串": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "方便面": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "意面": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "卤肉饭": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "炸鸡排": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "关东煮": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "蛋糕": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "抹茶蛋糕": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "巧克力蛋糕": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "磅蛋糕": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "蝴蝶酥面包": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "蛋挞": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "甜甜圈": {"搭配": "点你喜欢吃的", "快乐提示": INDULGE_快乐提示},
    "奶茶": {"搭配": "点你喜欢喝的", "快乐提示": INDULGE_快乐提示},
}

INDULGE_CALORIE_RANGE = (500, 1200)


def _random_calorie(low: int, high: int, step: int = 10) -> int:
    n = (high - low) // step + 1
    return low + random.randint(0, max(0, n - 1)) * step


def draw_diet() -> dict:
    """减脂：等概率抽一个品类；菜品名=品类（存库用）；热量按品类覆盖或分类区间。"""
    name = random.choice(list(DIET_FOODS.keys()))
    info = DIET_FOODS[name]
    low, high = DIET_CALORIE_OVERRIDE.get(name) or DIET_CALORIE_BY_CATEGORY.get(
        DIET_CATEGORY_MAP.get(name, "中式快餐类"), (300, 450)
    )
    return {
        "品类": name,
        "菜品名": name,
        "搭配": info["搭配"],
        "注意事项": info["注意事项"],
        "快乐提示": None,
        "热量": _random_calorie(low, high),
        "模式": "减脂",
    }


def draw_indulge() -> dict:
    """放纵：等概率抽一个品类；菜品名=品类（存具体名）；快乐提示。"""
    name = random.choice(list(INDULGE_FOODS.keys()))
    info = INDULGE_FOODS[name]
    return {
        "品类": name,
        "菜品名": name,
        "搭配": info["搭配"],
        "注意事项": [],
        "快乐提示": info["快乐提示"],
        "热量": _random_calorie(*INDULGE_CALORIE_RANGE),
        "模式": "放纵",
    }


def draw(mode: str) -> dict:
    if mode == "放纵":
        return draw_indulge()
    return draw_diet()
